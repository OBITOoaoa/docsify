# 高低温、批量和冒烟测试

高低温测试、批量测试和冒烟测试是常见的 onu 测试。

这三个测试的基础就是先熟悉打流操作，打流的基本流程就是使用打流仪模拟数据包的发送和接受。

## 打流操作

思博伦打流仪，

打流打不通，或者丢包时，先排查一下环境配置，包括但不限于以下几点：

*   检查网线、光纤连接
*   检查 OLT、ONU 端口 VLAN 配置
    *   组播、三层流要添加 UDP 头
    *   定制版本也需要添加 UDP 头
*   检查设备端口速率协商情况，如 ONU 是否接到 FE 口
*   打 DHCP 流要确保 ONU LAN DHCP 关闭
*   检查是否绑了ONU DBA 模板以及 OLT 端口是否限速

## 高低温测试

确定产品在高温、低温或温度突变等条件下的稳定性。

高低温测试本质上就是将 onu 设备放到高低温箱里面，连接打流仪和 olt 搭建环境，最后设置高低温箱的温度（高温、低温、温循），进行长时打流测试即可。

至少有一台设备要满载，所有 LAN 口都接上打流，

## 批量测试

验证批量 ONU 长时运行的稳定性。

olt 连接大量 onu 设备进行管理，可以批量升级 onu 设备、使用脚本（telnetX6）批量配置 onu 设备和上网业务配置。

```shell
# 进入特权模式
en

# 进入全局配置模式
configure terminal
或者 c t

# 进入 epon/gpon 的 0/1 口
interface epon 0/1
interface gpon 0/1

# 显示onu 1 设备的配置信息
show running-config onu 1
```

## 冒烟测试

执行冒烟测试的主要目的是快速验证软件基本功能是否有缺陷。如果冒烟测试的测试例不能通过，则不必做进一步的测试。避免在正式测试阶段全面开展后甚至到测试中后期才发现致命性的缺陷，从而影响测试进度以及浪费人力物力。

## WiFi测试

WiFi 屏蔽箱的作用是提供一个隔离的测试环境，避免外部干扰（如电磁干扰、网络干扰等）对测试结果的影响。

查看 WAN 是否有设置 bridge，不能设置 bridge，设置 bridge 相当于直接打通不太符合实际上网环境，测试出来的数据不准确。

设置每个频段的频宽为最大：

*   2.4G：40 MHz
*   5G：80MHz or 160MHz（AX30）

WiFi 屏蔽箱内测试 WiFi 速率（发送和接收两个方向）。

*   n（802.11 n）：WiFi 4
*   AC（802.11 ac）：WiFi 5
*   AX（802.11 ax）：WiFi 6

不带 AX 的 ONU 设备协商速率（理论速率）：

*   2.4G：300 Mbps
*   5G：866 Mbps

带 AX15 的 ONU 设备协商速率（理论速率）：只增强 5G

*   2.4G：300 Mbps
*   5G：1204 Mbps

带 AX（没写数字，其实是 AX18） 的 ONU 设备协商速率（理论速率）：增强 2.4G 和 5G

*   2.4G：574 Mbps
*   5G：1201 Mbps

带 AX30 的 ONU 设备协商速率（理论速率）：

*   2.4G：574 Mbps
*   5G：2402 Mbps

WiFi 测试吞吐量时，如果吞吐量太小，可以从以下方面尝试解决：

*   进入 Web 界面切换信道
*   重启网卡
*   查看信号强度，尝试改变信号强度
*   测试时，需要关闭其他会影响 WiFi 速率的软件，比如扫描周围强度的绿色图标软件

## 版本发布测试

\
定制版本：

*   定制版本需要先测试定制需求，定制需求通过再进行业务和打流测试，定制需求不通过直接退回修改。
*   定制版本一般有 lock，lock 的话限制只能升级客户的定制版本，需要先升 unlock 版本再升级其他版本。
*   定制版本一般有 dns 限制，dns 限制的话跑业务可能跑不通（国外 dns 可能在国内环境通不了），所以需要进入 telnet 接触 dns 限制。

```shell
# 设置dns限制，0关闭，1开启
flash set WAN_DNSPOOL_CHECK 0/1

# 查看lock/unlock，有就是lock,没有就是unlock
cat tmp/weblock_ver

# 查看mac地址
flash get ELAN_MAC_ADDR 

# 设置mac地址
flash set ELAN_MAC_ADDR xxx

# 查看硬件版本号
flash get HW_PRIVATE_HWVER

# 修改sn 
flash set GPON_SN xxxx

# 查看校验结果
cat /tmp/authinfo

# 修改model 厂商id
flash set PON_VENDOR_ID xxxx
```

RIDE 自动化测试设备基本功能、业务和打流情况等。

*   业务

    *   需要接 LAN 口，有 3 条，电脑都设置了静态 IP，1、2、3 网段。
*   打流，正常情况下：实际情况接线得分析。

    *   EPON：上联口 1，ONU 3
    *   GPON：上联口 2，ONU 4

## CATV

光电转换后光的功率大约在 +2dBm 到 -10dBm 差不多，信号较好。

### 信号传输链路总结：

1.  **网络连接**：
    *   电视盒子通过网线连接到网络，获取网络数据。

2.  **数字信号输出**：
    *   电视盒子通过HDMI接口输出数字信号到调制器。

3.  **数字信号转换为模拟信号**：
    *   调制器将 HDMI 输出的数字信号转换为模拟信号，并将其调制到一个特定的频率。

4.  **模拟信号转换为光信号**：
    *   CATV 转换器将调制器输出的模拟信号（电信号）转换为光信号。

5.  **光信号传输**：
    *   光信号通过光纤传输到 ONU 的 PON 口。

6.  **光信号转换为模拟信号**：
    *   ONU 将接收到的光信号转换为模拟信号，并通过 CATV 输出口输出。

7.  **模拟信号输出到机顶盒**：
    *   模拟信号通过同轴电缆连接到机顶盒。

8.  **机顶盒输出到电视**：
    *   机顶盒将信号输出到电视，最终电视机显示画面。

